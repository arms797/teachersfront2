import{b as k,c as S,r as l,j as e,a as g}from"./index-CuiF2JwL.js";const T=()=>{const{userInfo:t,loading:p}=k(),{activeTerm:i,selectedTerm:a,setSelectedTerm:d,allTerms:v,loading:m}=S(),[n,b]=l.useState(""),[h,N]=l.useState(""),[u,c]=l.useState(!1),[x,r]=l.useState(null),[j,o]=l.useState(null);l.useEffect(()=>{i&&!a&&d(i)},[i,a,d]);const y=async()=>{if(!(!t||!a)){c(!0),r(null),o(null);try{const s={cooperationType:n,term:a,description:h,username:t.username,fullName:t.fullName,centerCode:t.centerCode},f=await g.post("/api/ScheduleLock/lock-by-cooperation",s);r(`برای تعداد ${f.teachersCount} استاد ، قفل گذاری صورت گرفت`)}catch(s){o(s.response?.data?.message||"خطا در قفل‌گذاری")}finally{c(!1)}}},C=async()=>{if(!(!t||!a)){c(!0),r(null),o(null);try{const s={cooperationType:n,term:a},f=await g.post("/api/ScheduleLock/unlock-by-cooperation",s);r(`برای اساتید ${n}، قفل برنامه ترمی باز شد`)}catch(s){o(s.response?.data?.message||"خطا در حذف قفل‌ها")}finally{c(!1)}}};return e.jsxs("div",{className:"card p-3 shadow-sm",children:[e.jsx("h5",{className:"mb-3",children:"مدیریت قفل گروهی اساتید"}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{children:"نوع همکاری"}),e.jsxs("select",{className:"form-select",value:n,onChange:s=>b(s.target.value),children:[e.jsx("option",{value:"همه اساتید",children:"همه اساتید"}),e.jsx("option",{value:"عضو هیات علمی",children:"عضو هیات علمی"}),e.jsx("option",{value:"مدرس مدعو",children:"مدرس مدعو"})]})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{children:"ترم"}),e.jsxs("select",{className:"form-select",value:a||"",onChange:s=>d(s.target.value),disabled:m,children:[e.jsx("option",{value:"",children:"انتخاب کنید..."}),v.map(s=>e.jsxs("option",{value:s.term,children:[s.term," ",s.active?"(فعال)":""]},s.term))]})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{children:"توضیحات (اختیاری)"}),e.jsx("input",{type:"text",className:"form-control",value:h,onChange:s=>N(s.target.value)})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-danger",disabled:u||p||m,onClick:y,children:"قفل کردن گروهی برنامه هفتگی اساتید"}),e.jsx("button",{className:"btn btn-success",disabled:u||p||m,onClick:C,children:"باز کردن گروهی قفل برنامه هفتگی اساتید"})]}),u&&e.jsx("p",{className:"text-info mt-3",children:"در حال انجام عملیات..."}),x&&e.jsx("p",{className:"text-success mt-3",children:x}),j&&e.jsx("p",{className:"text-danger mt-3",children:j})]})};export{T as default};
