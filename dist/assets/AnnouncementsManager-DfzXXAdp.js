import{r as l,b as f,j as e,a as c}from"./index-DPEWr26x.js";function N(){const[o,m]=l.useState([]),[s,a]=l.useState({id:null,title:"",body:"",startDate:"",endDate:"",isActive:!0,createdBy:"",createdDate:""}),[h,i]=l.useState(!1),[d,n]=l.useState(null),{userInfo:u}=f();async function r(){i(!0);try{const t=await c.get("/api/announcement");m(t||[])}catch{n("خطا در دریافت اطلاعیه‌ها")}finally{i(!1)}}l.useEffect(()=>{r()},[]);async function x(){try{if(!s.title||s.title.trim()===""||!s.body||s.body.trim()===""){n("عنوان و متن اطلاعیه نباید خالی باشند.");return}const t={...s,createdBy:u?.username||"system"};s.id?await c.put(`/api/announcement/${s.id}`,t):await c.post("/api/announcement",t),a({id:null,title:"",body:"",startDate:"",endDate:"",isActive:!0}),n(null),r()}catch{n("خطا در ذخیره اطلاعیه")}}async function b(t){if(window.confirm("آیا مطمئن هستید؟"))try{await c.delete(`/api/announcement/${t}`),r()}catch{n("خطا در حذف اطلاعیه")}}function j(t){a({id:t.id,title:t.title,body:t.body,startDate:t.startDate,endDate:t.endDate,isActive:t.isActive})}return e.jsxs("div",{className:"container mt-4",children:[e.jsx("h4",{className:"mb-3",children:"مدیریت اطلاعیه‌ها"}),e.jsx("div",{className:"card mb-4",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"عنوان"}),e.jsx("input",{type:"text",className:"form-control",value:s.title,onChange:t=>a({...s,title:t.target.value})})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"متن"}),e.jsx("textarea",{className:"form-control",rows:"3",value:s.body,onChange:t=>a({...s,body:t.target.value})})]}),e.jsxs("div",{className:"row mb-2",children:[e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"تاریخ شروع"}),e.jsx("input",{type:"text",className:"form-control",value:s.startDate||"",onChange:t=>a({...s,startDate:t.target.value})})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"تاریخ پایان"}),e.jsx("input",{type:"text",className:"form-control",value:s.endDate||"",onChange:t=>a({...s,endDate:t.target.value})})]}),e.jsx("div",{className:"col-md-2 d-flex align-items-center",children:e.jsxs("div",{className:"form-check mt-4",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",checked:s.isActive,onChange:t=>a({...s,isActive:t.target.checked})}),e.jsx("label",{className:"form-check-label",children:"فعال"})]})})]}),e.jsx("button",{className:"btn btn-success me-2",onClick:x,disabled:!s.title.trim()||!s.body.trim(),children:s.id?"ویرایش اطلاعیه":"افزودن اطلاعیه"}),s.id&&e.jsx("button",{className:"btn btn-secondary",onClick:()=>a({id:null,title:"",body:"",startDate:"",endDate:"",isActive:!0}),children:"انصراف"})]})}),h?e.jsx("div",{children:"در حال بارگذاری..."}):d?e.jsx("div",{className:"alert alert-danger",children:d}):e.jsxs("table",{className:"table table-bordered table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"عنوان"}),e.jsx("th",{children:"تاریخ شروع"}),e.jsx("th",{children:"تاریخ پایان"}),e.jsx("th",{children:"فعال؟"}),e.jsx("th",{children:"ایجاد کننده"}),e.jsx("th",{children:"عملیات"})]})}),e.jsx("tbody",{children:o.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.title}),e.jsx("td",{children:t.startDate}),e.jsx("td",{children:t.endDate}),e.jsx("td",{children:t.isActive?"✅":"❌"}),e.jsx("td",{children:t.createdBy}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-sm btn-primary me-2",onClick:()=>j(t),children:"ویرایش"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>b(t.id),children:"حذف"})]})]},t.id))})]})]})}export{N as default};
