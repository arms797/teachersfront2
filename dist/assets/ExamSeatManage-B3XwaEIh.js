import{r as a,j as e,a as o}from"./index-BweMn421.js";function C(){const[m,N]=a.useState([]),[h,x]=a.useState(!1),[j,u]=a.useState(null),[b,n]=a.useState(null),[p,f]=a.useState(null),[s,g]=a.useState(null),c=async()=>{x(!0),u(null);try{const t=await o.get("/api/examseat");console.log(t);const d=(t.data||[]).sort((r,i)=>r.date===i.date?r.time.localeCompare(i.time):r.date.localeCompare(i.date));N(d)}catch{u("خطا در دریافت اطلاعات خلاصه")}finally{x(!1)}};a.useEffect(()=>{c()},[]);const y=async()=>{if(s)try{await o.delete(`/api/examseat/${s.date}/${s.time}`),n("رکوردهای متناظر حذف شدند."),g(null),c()}catch{n("خطا در حذف رکوردها")}},v=async t=>{const l=t.target.files[0];if(!l)return;f(l);const d=new FormData;d.append("file",l);try{await o.post("/api/examseat",d,{headers:{"Content-Type":"multipart/form-data"}}),n("فایل با موفقیت بارگذاری شد."),f(null),c()}catch{n("خطا در بارگذاری فایل اکسل")}};return e.jsxs("div",{className:"container mt-4",children:[e.jsx("h3",{className:"fw-bold text-primary mb-3",children:"خلاصه شماره صندلی امتحانات"}),b&&e.jsx("div",{className:"alert alert-info",children:b}),j&&e.jsx("div",{className:"alert alert-danger",children:j}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"btn btn-success",children:["افزودن رکوردها از فایل اکسل",e.jsx("input",{type:"file",accept:".xlsx,.xls",hidden:!0,onChange:v})]}),p&&e.jsx("span",{className:"ms-2",children:p.name})]}),h&&e.jsx("div",{children:"در حال بارگذاری..."}),e.jsxs("table",{className:"table table-bordered text-center",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"تاریخ"}),e.jsx("th",{children:"ساعت"}),e.jsx("th",{children:"تعداد دانشجو"}),e.jsx("th",{children:"عملیات"})]})}),e.jsxs("tbody",{children:[m.map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:t.date}),e.jsx("td",{children:t.time}),e.jsx("td",{children:t.count}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>g(t),"data-bs-toggle":"modal","data-bs-target":"#deleteModal",children:"حذف"})})]},l)),m.length===0&&!h&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"هیچ داده‌ای موجود نیست"})})]})]}),e.jsx("div",{className:"modal fade",id:"deleteModal",tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"تأیید حذف"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"بستن"})]}),e.jsx("div",{className:"modal-body",children:s&&e.jsxs("p",{children:["آیا مطمئن هستید که می‌خواهید رکوردهای تاریخ ",e.jsx("strong",{children:s.date})," و ساعت ",e.jsx("strong",{children:s.time})," حذف شوند؟"]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"انصراف"}),e.jsx("button",{type:"button",className:"btn btn-danger","data-bs-dismiss":"modal",onClick:y,children:"حذف"})]})]})})})]})}export{C as default};
