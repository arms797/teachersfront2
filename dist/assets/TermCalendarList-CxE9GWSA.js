import{r,c as w,a as l,j as e}from"./index-DPEWr26x.js";function S(){const[d,f]=r.useState([]),[b,u]=r.useState(!0),[x,n]=r.useState(null),[a,m]=r.useState({term:"",title:"",start:"",end:""}),[o,j]=r.useState(!1),{refreshTerms:p}=w();r.useEffect(()=>{i()},[]);async function i(){u(!0);try{const t=await l.get("/api/TermCalender");f(t)}catch{n("خطا در دریافت تقویم ترمی")}finally{u(!1)}}function c(t){const{name:s,value:h}=t.target;m(C=>({...C,[s]:h}))}async function g(t){t.preventDefault();try{o?(await l.put(`/api/TermCalender/${a.term}`,a),n("ویرایش با موفقیت انجام شد")):(await l.post("/api/TermCalender",a),n("ترم جدید ثبت شد")),m({term:"",title:"",start:"",end:""}),j(!1),i(),p()}catch(s){n(s.message||"خطا در ذخیره اطلاعات")}}function v(t){const s=d.find(h=>h.term===t);s&&(m({term:s.term,title:s.title,start:s.start,end:s.end}),j(!0))}async function N(t){if(window.confirm(`آیا از حذف ترم ${t} مطمئن هستید؟`))try{await l.delete(`/api/TermCalender/${t}`),n("ترم حذف شد"),i(),p()}catch{n("خطا در حذف ترم")}}async function y(t){try{await l.put(`/api/TermCalender/activate/${t}`),n(`ترم ${t} فعال شد`),i()}catch{n("خطا در فعال‌سازی ترم")}}return e.jsxs("div",{children:[e.jsx("h6",{children:"لیست تقویم ترمی"}),x&&e.jsx("div",{className:"alert alert-info",children:x}),e.jsxs("form",{onSubmit:g,className:"row g-2 mb-4",children:[e.jsx("div",{className:"col-md-2",children:e.jsx("input",{type:"text",name:"term",className:"form-control",placeholder:"کد ترم",value:a.term,onChange:c,required:!0,disabled:o})}),e.jsx("div",{className:"col-md-3",children:e.jsx("input",{type:"text",name:"title",className:"form-control",placeholder:"عنوان ترم",value:a.title,onChange:c,required:!0})}),e.jsx("div",{className:"col-md-3",children:e.jsx("input",{type:"text",name:"start",className:"form-control",placeholder:"مثال: 1403/07/15",value:a.start,onChange:c,pattern:"\\d{4}/\\d{2}/\\d{2}",title:"فرمت باید به صورت 1403/07/15 باشد",required:!0})}),e.jsx("div",{className:"col-md-3",children:e.jsx("input",{type:"text",name:"end",className:"form-control",placeholder:"مثال: 1403/07/15",value:a.end,onChange:c,pattern:"\\d{4}/\\d{2}/\\d{2}",title:"فرمت باید به صورت 1403/07/15 باشد",required:!0})}),e.jsx("div",{className:"col-md-1",children:e.jsx("button",{type:"submit",className:"btn btn-primary w-100",children:o?"ویرایش":"افزودن"})})]}),b?e.jsx("div",{children:"در حال بارگذاری..."}):e.jsxs("table",{className:"table table-bordered table-sm text-center align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"کد ترم"}),e.jsx("th",{children:"عنوان"}),e.jsx("th",{children:"شروع"}),e.jsx("th",{children:"پایان"}),e.jsx("th",{children:"وضعیت"}),e.jsx("th",{children:"عملیات"})]})}),e.jsxs("tbody",{children:[d.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.term}),e.jsx("td",{children:t.title}),e.jsx("td",{children:t.start?.substring(0,10)}),e.jsx("td",{children:t.end?.substring(0,10)}),e.jsx("td",{children:e.jsx("span",{className:`badge bg-${t.active?"success":"secondary"}`,children:t.active?"فعال":"غیرفعال"})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-2 justify-content-center",children:[!t.active&&e.jsx("button",{className:"btn btn-sm btn-outline-success",onClick:()=>y(t.term),children:"فعال‌سازی"}),e.jsx("button",{className:"btn btn-sm btn-outline-warning",onClick:()=>v(t.term),children:"ویرایش"}),e.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>N(t.term),children:"حذف"})]})})]},t.term)),d.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"هیچ تقویمی ثبت نشده است."})})]})]})]})}export{S as default};
